"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3954],{3954:(_,d,u)=>{u.r(d),u.d(d,{CameraWeb:()=>p,Camera:()=>h});var o=u(5861),m=u(7423),l=u(76);class p extends m.Uw{getPhoto(e){var n=this;return(0,o.Z)(function*(){return new Promise(function(){var t=(0,o.Z)(function*(s,a){if(e.webUseInput||e.source===l.oK.Photos)n.fileInputExperience(e,s);else if(e.source===l.oK.Prompt){let r=document.querySelector("pwa-action-sheet");r||(r=document.createElement("pwa-action-sheet"),document.body.appendChild(r)),r.header=e.promptLabelHeader||"Photo",r.cancelable=!1,r.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],r.addEventListener("onSelection",function(){var i=(0,o.Z)(function*(c){0===c.detail?n.fileInputExperience(e,s):n.cameraExperience(e,s,a)});return function(c){return i.apply(this,arguments)}}())}else n.cameraExperience(e,s,a)});return function(s,a){return t.apply(this,arguments)}}())})()}cameraExperience(e,n,t){var s=this;return(0,o.Z)(function*(){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");document.body.appendChild(a);try{yield a.componentOnReady(),a.addEventListener("onPhoto",function(){var r=(0,o.Z)(function*(i){const c=i.detail;null===c?t(new m.xz("User cancelled photos app")):c instanceof Error?t(c):n(yield s._getCameraPhoto(c,e)),a.dismiss(),document.body.removeChild(a)});return function(i){return r.apply(this,arguments)}}()),a.present()}catch(r){s.fileInputExperience(e,n)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements."),s.fileInputExperience(e,n)})()}fileInputExperience(e,n){let t=document.querySelector("#_capacitor-camera-input");const s=()=>{var a;null===(a=t.parentNode)||void 0===a||a.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",a=>{const r=t.files[0];let i="jpeg";if("image/png"===r.type?i="png":"image/gif"===r.type&&(i="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const c=new FileReader;c.addEventListener("load",()=>{if("dataUrl"===e.resultType)n({dataUrl:c.result,format:i});else if("base64"===e.resultType){const f=c.result.split(",")[1];n({base64String:f,format:i})}s()}),c.readAsDataURL(r)}else n({webPath:URL.createObjectURL(r),format:i}),s()})),t.accept="image/*",t.capture=!0,e.source===l.oK.Photos||e.source===l.oK.Prompt?t.removeAttribute("capture"):e.direction===l.GW.Front?t.capture="user":e.direction===l.GW.Rear&&(t.capture="environment"),t.click()}_getCameraPhoto(e,n){return new Promise((t,s)=>{const a=new FileReader,r=e.type.split("/")[1];"uri"===n.resultType?t({webPath:URL.createObjectURL(e),format:r,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const i=a.result;t("dataUrl"===n.resultType?{dataUrl:i,format:r,saved:!1}:{base64String:i.split(",")[1],format:r,saved:!1})},a.onerror=i=>{s(i)})})}checkPermissions(){var e=this;return(0,o.Z)(function*(){if("undefined"==typeof navigator||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(n){throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,o.Z)(function*(){throw e.unimplemented("Not implemented on web.")})()}}const h=new p}}]);