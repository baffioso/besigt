<ion-header>
  <ion-segment mode='md' [(ngModel)]="segment" class="ion-padding-top">
    <ion-segment-button value="overlays">
      <ion-icon name="layers-outline"></ion-icon>
    </ion-segment-button>
    <ion-segment-button value="baselayers">
      <ion-icon name="map-outline"></ion-icon>
    </ion-segment-button>
  </ion-segment>
</ion-header>

<ion-content>

  <ng-container *ngIf="segment === 'overlays'">
    <ion-list *ngFor="let overlay of overlays$ | async; trackBy:trackItems">
      <ion-accordion-group>
        <ion-accordion>
          <ion-item slot="header">
            <ion-icon [name]="overlay.icon" slot="start"></ion-icon>
            <ion-label>{{overlay.name}}</ion-label>
            <ion-badge color="secondary">{{overlay.layerCount.added}}/{{overlay.layerCount.total}}</ion-badge>
          </ion-item>

          <ion-item slot="content" *ngFor="let layer of overlay.layers; trackBy:trackItems">
            <ion-label>{{layer.label}}</ion-label>
            <ion-toggle (ionChange)="onOverlayToggle($event, overlay, layer)" mode="md" slot="end" [name]="layer.name"
              [checked]="layer.addedToMap">
            </ion-toggle>
          </ion-item>
        </ion-accordion>
      </ion-accordion-group>
    </ion-list>
  </ng-container>

  <ng-container *ngIf="segment === 'baselayers'">
    <ion-grid>
      <ion-row>
        <ion-col size="4" *ngFor="let baseMap of baseMaps$ | async" class="ion-text-center">
          <div class="base-map" (click)="onBaseLayerSelect(baseMap)">
            <ion-card [ngClass]=" {'selected': baseMap.id === (selectedBaseMap$ | async)}">
              <ion-img [src]="baseMap.image"></ion-img>
            </ion-card>
            <ion-text color="medium" [ngClass]="{'selected': baseMap.id === (selectedBaseMap$ | async)}">
              {{baseMap.name}}
            </ion-text>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-container>

</ion-content>

<ion-fab vertical="bottom" horizontal="center" slot="fixed">
  <ion-fab-button size="small" color="primary" (click)="dismiss()">
    <ion-icon name="checkmark"></ion-icon>
  </ion-fab-button>
</ion-fab>